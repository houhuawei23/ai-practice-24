# 基于第二次世界大战天气状况的探索性数据分析与预测

## 任务目的

对二战中的空袭行动与天气状况数据进行分析，基于第二次世界大战中的空中轰炸行动和天气状况的多种数据源，利用 EDA (Exploratory Data Analysis)分析数据并对数据进行清理，根据时间序列预测方式，预测出轰炸目标城市、天气状况以及行动何时完成等。

## 任务内容

- 下载数据集
- 数据清洗
- 数据可视化
  - 袭击了多少个国家
  - 主要目标国家
  - 十大飞机系列
  - 起飞基地位置（攻击国家）
  - 目标位置
  - 轰炸路径
  - 战区
  - 气象站位置
- 基于 ARIMA 的时间序列预测
  - 时间序列的季节性趋势
  - 检查时间序列的平稳性
  - 避免趋势性和季节性的方法
  - 预测时间序列
  - 预测和可视化所有路径并查找均方误差

## 任务原理

Plotly 库：Plotly 图形库可以在线生成交互式的、出版物质量的图形。以及制作折线图、散点图、面积图、条形图、误差线、方框图、直方图、热图、子图、多轴、极坐标图和气泡图等数据分析图形。

## 任务详情

### 1. 数据清洗

- 空袭数据包含了大量的 NaN 值。项目中没有使用它们，而是删除了一些 NaN 值。它不仅消除了不确定性，而且是一个可视化的过程。
  - 删除值为 NaN 的国家
  - 如果目标经度为 NaN，则删除
  - 起飞经度为 NaN 时删除
  - 删除未使用的特征
- 天气状况数据不需要任何清理。通过对勘探数据的分析和可视化，选择一定的地点进行深入研究。只放入使用的数据变量。

### 2. 数据可视化

- 袭击了多少个国家
- 主要目标国家
- 十大飞机系列
- 起飞基地位置（攻击国家）
- 目标位置
- 轰炸路径
- 战区
- 气象站位置

聚焦美缅战争:

- 在这场战争中，美国从 1942 年到 1945 年轰炸了缅甸（卡萨市）。
- 距离这场战争最近的气象站是宾杜库里，它有 1943 年至 1945 年的气温记录。

从 1943 年到 1945 年进行了温度测量。

- 温度在 12 到 32 度之间。
- 冬季的温度比夏季的温度低。

### 3. 基于 ARIMA 的时间序列预测

- 时间序列的季节性趋势
- 检查时间序列的平稳性
- 使时间序列静止
- 避免趋势性和季节性的方法
- 预测时间序列
- 使用（1,0,1）作为 ARIMA 模型的参数并预测
- 预测和可视化所有路径并查找均方误差

#### 3.1 时间序列的季节性趋势

从上图可以看出，时间序列有季节性变化。夏季平均气温较高，冬季平均气温较低。

#### 3.2 检查时间序列的平稳性

可以使用以下方法检查平稳性：

- 绘制滚动统计：有一个窗口，假设窗口大小为 6，然后找到滚动均值和方差来检查平稳性。
- Dickey-Fuller 检验：检验结果包括一个检验统计量和一些不同置信水平的临界值。如果检验统计量小于临界值，可以说时间序列是平稳的。

对于平稳的第一个标准是常数均值。所以不符合标准，因为平均值不是常数，正如从上面的图（黑线）看到的(无静止）。

第二个是常数方差。它看起来是恒定的（静止）。

第三，如果检验统计量小于临界值，可以说时间序列是平稳的。

```python
检验统计量=-1.4，临界值={1%：-3.439229783394421，'5%：-2.86545894814762，'10%：-2.5688568756191392}。
```

验统计量大于临界值(无静止）。

因此，我们时间序列不是平稳的。

#### 3.3 使时间序列静止

如前所述，时间序列的非平稳性背后有两个原因：

- 趋势：随时间变化的平均值。我们需要时间序列平稳的常数均值。
- 季节性：特定时间的变化。我们需要时间序列平稳的常数变化。

先解趋势（常均值）问题。最流行的方法是移动平均法。

- 移动平均线：有一个窗口，用来计算过去 n 个样本的平均值是窗口大小。
- 常量平均值标准：从上面的图（黑线）可以看出，平均值看起来像常量(静止)。
  第二个是常数方差。它看起来是恒定的(静止）。
  检验统计量小于 1%的临界值，所以 99%的置信度说这是一个平稳序列(是（静止），实现了平稳时间序列。

#### 3.3 避免趋势性和季节性的方法

- 差分法：是最常用的方法之一。其思想是取时间序列和移位时间序列之间的差。
- 常量平均值标准：从上面的图（黑线）可以看出，平均值看起来像常量(静止）。
- 第二个是常数方差。它看起来是恒定的(静止）
- 检验统计量小于 1%的临界值，所以 99%的置信度说这是一个平稳序列(是（静止）

#### 3.4 预测时间序列

上文学习了两种不同的方法：移动平均法和差分法，以避免趋势和季节性问题。
使用差分方法进行预测时间序列。同时，预测方法为自回归综合移动平均值 ARIMA。

- AR：自回归（p）：AR 项只是依赖变量的滞后。例如，假设 p 是 3，则使用 x（t1）、x（t-2）和 x（t-3）来预测 x（t）。
- I： 综合（d）：这些是非测量差异的数量。例如，在例子中采用一阶差。传递这个变量，然后把 d=0。
- MA：移动平均值（q）：MA 项是预测方程中滞后预测误差。
  （p，d，q）是 ARIMA 模型的参数。
  为了选择 p，d，q 参数，将使用两个不同的图。
- 自相关函数（ACF）：时间序列与滞后时间序列相关性的测量。
- 部分自相关函数（PACF）：测量时间序列与滞后时间序列之间的相关性。

两条虚线是置信区间。使用这些线来确定“p”和“q”值。
选择 p：PACF 图表第一次穿过上置信区间的滞后值。p=1。
选择 q：ACF 图表第一次穿过置信区间上限的滞后值。q=1。

#### 使用（1,0,1）作为 ARIMA 模型的参数并预测

ARIMA：来自 statsmodels 库。
datetime：使用它的 start 和 end 索引的 predict 方法。

#### 预测和可视化所有路径并查找均方误差

## Python Lib

### Plotly

An open-source, interactive data visualization library for Python

### chart-studio

This package contains utilities for interfacing with Plotly's Chart Studio service (both Chart Studio cloud and Chart Studio On-Prem). Prior to plotly.py version 4, This functionality was included in the plotly package under the plotly.plotly module. As part of plotly.py version 4, the Chart Studio functionality was removed from the plotly package and released in this chart-studio package.
